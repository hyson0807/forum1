<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/main.css" rel="stylesheet">

</head>
    <body class="grey-bg">
        <%- include('nav.ejs') %>

        
            <input class="search">
            <button class="search-send">ê²€ìƒ‰</button>

            <script>
                document.querySelector('.search-send').addEventListener('click', function(){
                    let ì…ë ¥í•œê±° = document.querySelector('.search').value 
                    location.href = '/search?val=' + ì…ë ¥í•œê±° 
                })
            </script>


        

        <div class="white-bg">
            <% for(let i = 0; i < ê¸€ëª©ë¡.length; i++) { %>
                <div class="list-box">
                    <h4>
                        <a href="detail/<%= ê¸€ëª©ë¡[i]._id %>">
                            <%= ê¸€ëª©ë¡[i].title %>
                        </a>
                        <a href="/edit/<%= ê¸€ëª©ë¡[i]._id %>">âœï¸</a>
                        <span class="delete" data-id="<%= ê¸€ëª©ë¡[i]._id %>">ğŸ—‘ï¸</span>
                    </h4>
                    <p><%= ê¸€ëª©ë¡[i].content %></p>
                    <p><%= ê¸€ëª©ë¡[i].createdAt %></p>
                  </div>
            <% } %>   
        </div>
        
        <div class="page">
            <% for(let i=0; i < ê¸€ëª©ë¡.length; i++) { %>
                <a href="/list/<%= (i+1) %>"> <%= (i+1) %> </a>
            <% } %>
            <br>
            
            <a href="/list/next/<%= ê¸€ëª©ë¡[ê¸€ëª©ë¡.length-1]._id %>">ë‹¤ìŒ í˜ì´ì§€</a>
        </div>


        


        <script>
            document.querySelectorAll('.delete').forEach(function(element) {
                element.addEventListener('click', function(e) {
                    fetch('/delete?docid=' + e.target.dataset.id, {
                        method : 'DELETE'
                    })
                    .then((r) => r.text())
                    .then((r) => { 
                        e.target.parentElement.parentElement.style.display = 'none'
                     } )

                })
            })
        </script>
      </body>
      
</html>

  
